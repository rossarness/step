#:kivy 1.0.9
#:import hex kivy.utils.get_color_from_hex

<StatsLabel>:
        color: hex('#000000')
        bold: True
        size_hint: None, None
        text_size: self.size

<Equipment>:
        padding: 5
        size_hint: 0.5, 1
        width: 250
        id: _equipment
        item_list: _item_list
        helm: _helm
        cape: _cape
        boots: _boots
        hand_1: _hand_1
        hand_2: _hand_2
        weapon_1: _weapon_1
        weapon_2: _weapon_2
        armor: _armor
        StepRow:
                height: 50
                pos_hint: {'top': 1}
                canvas:
                        Color:
                                rgba: 0.3, 0.3, 0.3, 1
                        Rectangle:
                                pos: self.pos
                                size: self.size
                SectionLabel:
                        text: "EKWIPUNEK"
                        pos_hint: {'top': 1}
        StepAnchor:
                pos_hint: {'top': 0.9}
                size_hint: 0.4, 1
                anchor_x: 'left'
                anchor_y: 'top'
                canvas:
                        Color:
                                rgba: 0.7, 0.7, 0.7, 1
                        Rectangle:
                                pos: self.pos
                                size: self.size
                RelativeLayout:
                        canvas:
                                Color:
                                        rgba: 0.7, 0.7, 0.7, 1
                                Rectangle:
                                        pos: self.pos
                                        size: self.size
                                Color:
                                        rgba: 0.9, 0.9, 0.9, 1
                                Rectangle:
                                        pos: self.x+10, self.top*0.15
                                        size: self.width*0.9, self.height*0.35
                        EquipmentButton:
                                id: _helm
                                equipment: _equipment
                                eq_id: "helm"
                                name: "Helm"
                                pos_hint: {'top': 0.95, 'center_x': 0.5}
                                size_hint: 0.2, None
                                size: 50, 50
                                source: 'res/images/head.png'
                                default_src: 'res/images/head.png'
                        EquipmentButton:
                                id: _cape
                                equipment: _equipment
                                eq_id: "cape"
                                name: "Plecy"
                                pos_hint: {'top': 0.98, 'center_x': 0.2}
                                size_hint: 0.25, None
                                size: 70, 70
                                source: 'res/images/cloak.png'
                                default_src: 'res/images/cloak.png'
                        EquipmentButton:
                                id: _armor
                                equipment: _equipment
                                eq_id: "armor"
                                name: "Zbroja"
                                pos_hint: {'top': 0.85, 'center_x': 0.5}
                                size_hint: 0.4, None
                                size: 100, 120
                                source: 'res/images/armor.png'
                                default_src: 'res/images/armor.png'
                        WeaponButton:
                                id: _weapon_1
                                eq_id: "weapon"
                                equipment: _equipment
                                name: "Pierwsza Bron"
                                pos_hint: {'top': 0.7, 'center_x': 0.15}
                                size_hint: 0.2, None
                                size: 50, 120
                                source: 'res/images/rifle.png'
                                default_src: 'res/images/rifle.png'
                        WeaponButton:
                                id: _weapon_2
                                eq_id: "weapon_2"
                                equipment: _equipment
                                name: "Druga Bron"
                                pos_hint: {'top': 0.7, 'center_x': 0.85}
                                size_hint: 0.2, None
                                size: 50, 120
                                source: 'res/images/rifle.png'
                                default_src: 'res/images/rifle.png'
                        EquipmentButton:
                                id: _hand_1
                                eq_id: "hand"
                                name: "Lewa Reka"
                                equipment: _equipment
                                pos_hint: {'top': 0.83, 'center_x': 0.85}
                                size_hint: 0.2, None
                                size: 60 , 60
                                source: 'res/images/hand.png'
                                default_src: 'res/images/hand.png'
                        EquipmentButton:
                                id: _hand_2
                                eq_id: "hand_2"
                                name: "Prawa Reka"
                                equipment: _equipment
                                pos_hint: {'top': 0.83, 'center_x': 0.15}
                                size_hint: 0.2, None
                                size: 60 , 60
                                source: 'res/images/hand.png'
                                default_src: 'res/images/hand.png'
                        EquipmentButton:
                                id: _boots
                                eq_id: "boots"
                                name: "Buty"
                                equipment: _equipment
                                pos_hint: {'top': 0.63, 'center_x': 0.5}
                                size_hint: 0.25, None
                                size: 60, 60
                                source: 'res/images/boot.png'
                                default_src: 'res/images/boot.png'
                        GridLayout:
                                pos_hint: {'top' : 0.48, 'right': 0.48}
                                size_hint: None, None
                                row_default_height: 20
                                row_force_default: True
                                cols: 2
                                StatsLabel:
                                        halign: "left"
                                        text: "PZ: "
                                        width: 100
                                StatsLabel:
                                        text: "0"
                                        halign: "right"
                                StatsLabel:
                                        halign: "left"
                                        text: "M16A2: "
                                        width: 100
                                StatsLabel:
                                        text: "2k6"
                                        halign: "right"
                                StatsLabel:
                                        halign: "left"
                                        text: "Luk Prosty: "
                                        width: 100
                                StatsLabel:
                                        text: "3k6"
                                        halign: "right"
        StepAnchor:
                pos_hint: {'top': 0.9, 'right': 1}
                size_hint: 0.6, 1
                anchor_x: 'right'
                anchor_y: 'top'
                canvas:
                        Color:
                                rgba: 0.5, 0.5, 0.5, 1
                        Rectangle:
                                pos: self.pos
                                size: self.size
                RelativeLayout:
                        canvas.before:
                                Color:
                                        rgba: 0.5, 0.5, 0.5, 1
                                Rectangle:
                                        pos: self.pos
                                        size: self.size
                                Color:
                                        rgba: 0.1, 0.1, 0.1, 0.8
                                Rectangle:
                                        pos: self.x*0.27, self.y*0.01+29
                                        size: self.width*0.80, self.height*0.9
                        Step_Label:
                                text: "PLECAK"
                                bold: 1
                                pos_hint: {'top': 1, 'x': .5}
                        GridLayout:
                                cols: 1
                                spacing: 2
                                pos_hint: {'top': 0.95}
                                EquipmentAddButton:
                                        equipment: _equipment
                                        item_list: _item_list
                                        text: "Dodaj"
                                EquipmentDeleteButton:
                                        id: _del
                                        item_list: _item_list
                                        equipment: _equipment
                                        text: "Usun"
                        RelativeLayout:
                                size_hint: 0.9, 0.8
                                pos_hint: {'top': 0.95, 'x': 0.15}
                                EquipmentList:
                                        id: _item_list
                                        equipment: _equipment
                                        del_btn: _del
                                        name: 'item'
                                        pos_hint: {'top': 0.95}
                                        pos: 20, 0
                                        viewclass: 'SelectableLabel'
                                        SelectableRecycleBoxLayout:
                                                id: _rv_layout
                                                spacing: 5
                                                default_size: None, dp(56)
                                                default_size_hint: 0.85, None
                                                size_hint: 1, None
                                                height: self.minimum_height
                                                orientation: 'vertical'
                                                multiselect: True
                                                touch_multiselect: True

<Inventory_Btn>:
        size: 100, 100
        size_hint: None, None
        text_size: 55, 45
        font_size: 15
        halign: 'center'
        valign: 'center'
        max_lines: 3

<Inventory_Item>:
        item_btn: _item_btn
        info_btn: _info_btn
        anchor_x: 'right'
        anchor_y: 'bottom'
        size: 100, 100
        size_hint: None, None
        Inventory_Item_Btn:
                id: _item_btn
        InfoButton:
                size: 25, 25
                id: _info_btn
                item_btn: _item_btn

<Inventory_Item_Btn>:
        canvas.before:
                Color:
                        rgba: hex('#808080')
                Rectangle:
                        pos: self.pos
                        size: self.size
        size: 98, 98
        size_hint: None, None

<InfoButton>:
        canvas.before:
                Color:
                        rgba: (128, 128, 128, 0.5)
                Ellipse:
                        pos: self.pos
                        size: self.size
        size_hint: None, None
        source: "res/info.png"

<InfoPopup>:
        size: 335, 400
        size_hint: None, .5
        auto_dismiss: False
        RelativeLayout:
                ScrollableLabel:
                        pos_hint:{'top': 1}
                        text: root.text
                Button:
                        pos_hint:{'top': 0.15}
                        text: "Zamknij"
                        size: 30, 30
                        size_hint: 1, None
                        on_release: root.dismiss()

<Add_Inventory_Item>:
        size: 200, 100
        size_hint: .4, .6
        title: "Dodaj przedmiot"
        auto_dismiss: False
        new_item: _item
        add_btn: _add
        stat_value: _stat_value
        image: _image
        chosen_image: _chosen_img
        RelativeLayout:
                Label:
                        size: 50, 30
                        text: "Nazwa:"
                        pos_hint: {'top': .98, 'right': 0.25}
                        size_hint: .3, None
                TextInput:
                        id: _item
                        size: 250, 30
                        size_hint: .7, None
                        multiline: False
                        pos_hint: {'top': .98, 'right': 1}
                Label:
                        size: 50, 30
                        text: "Ikona:"
                        pos_hint: {'top': 0.86, 'right': 0.25}
                        size_hint: .3, None
                TextInput:
                        id: _image
                        size: 250, 30
                        size_hint: .6, None
                        multiline: False
                        pos_hint: {'top': 0.86, 'right': .9}
                Button:
                        text: "LD"
                        pos_hint: {'top': 0.86, 'right': 1}
                        size: 30, 30
                        size_hint: .1, None
                        on_release: root.load_image()
                Label:
                        size: 50, 30
                        id: _stat_value
                        text: "Stat Placeholder"
                        pos_hint: {'top': .74, 'right': .25}
                        size_hint: .3, None
                TextInput:
                        id: _item_stat
                        size: 250, 30
                        size_hint: .7, None
                        multiline: False
                        pos_hint: {'top': .74, 'right': 1}
                Image:
                        canvas.before:
                                Color:
                                        rgba: 0.5, 0.5, 0.5, 1
                                Rectangle:
                                        pos: self.pos
                                        size: self.size
                        size: 50, 30
                        allow_stretch: False
                        id: _chosen_img
                        pos_hint: {'top': 0.5, 'right': .65}
                        size_hint: .3, .3
                        source: 'res/red_x.png'
                BoxLayout:
                        orientation: "horizontal"
                        spacing: 5
                        pos_hint: {'top': 1}
                        Button:
                                id: _add
                                text: "Dodaj"
                                size_hint: .5, .15
                                on_release: root.add_item()
                        Button:
                                text: "Anuluj"
                                size_hint: .5, .15
                                on_release: root.dismiss()

<LoadDialog>:
        BoxLayout:
                size: root.size
                pos: root.pos
                orientation: "vertical"
                FileChooserIconView:
                        id: filechooser

                BoxLayout:
                        size_hint_y: None
                        height: 30
                        Button:
                                text: "Cancel"
                                on_release: root.cancel()
                        Button:
                                text: "Load"
                                on_release: root.load(filechooser.path, filechooser.selection)

<EquipmentButton>:
        canvas.before:
                Color:
                        rgba: hex('#808080')
                Rectangle:
                        pos: self.pos
                        size: self.size 
